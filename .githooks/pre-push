#!/bin/bash
# Pre-push hook: Run linting before pushing

echo "üîç Running pre-push checks..."

# Check if ruff is installed
if ! command -v ruff &> /dev/null; then
    echo "‚ö†Ô∏è  ruff not found. Install with: pip install ruff"
    exit 1
fi

# Run Python linting
echo "üìù Checking Python code..."
ruff check .
if [ $? -ne 0 ]; then
    echo "‚ùå Python linting failed. Fix issues with: ruff check . --fix"
    exit 1
fi

# Run Python formatting check
echo "üìê Checking Python formatting..."
ruff format --check .
if [ $? -ne 0 ]; then
    echo "‚ùå Python formatting check failed. Format with: ruff format ."
    exit 1
fi

# Check HTML/CSS with prettier (optional)
if command -v npx &> /dev/null; then
    echo "üé® Checking HTML/CSS formatting..."
    npx prettier --check "templates/*.html" "templates/*.css" 2>/dev/null
    if [ $? -ne 0 ]; then
        echo "‚ö†Ô∏è  HTML/CSS not formatted. Format with: npx prettier --write 'templates/*.html' 'templates/*.css'"
        # Warning only, don't block push
    fi
fi

echo "‚úÖ All pre-push checks passed!"
exit 0

